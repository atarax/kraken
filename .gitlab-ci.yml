stages:
  - build
  - test
  - deploy

variables:
  DOCKER_REPOSITORY: ""
  CANDIDATE_IMAGE: "${CI_PROJECT_NAME}:candidate-${CI_COMMIT_SHA}"
  STABLE_IMAGE: "${CI_PROJECT_NAME}:${CI_COMMIT_SHA}"

build:
  image: golang 
  stage: build
  script:
    - export GOPATH='/go'
    - mkdir -p /go/src/github.com/atarax/kraken
    - cd /go/src/github.com/atarax/ 
    - git clone https://github.com/atarax/kraken
    - cd kraken
    - go get ./...
    - CGO_ENABLED=0 go build -o bin/kraken
    - docker build . -t atarax/kraken
test:
  stage: test
  script:
    - "echo hello"

deploy:
  stage: deploy
  script:
    - echo "hello"